<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <p>Previously, I gave a quick example of running a Ubuntu/Kali virtual machine, accessible easily in a web browser using Kasm. If you missed it, <a href="https://medium.com/@plegg/quick-setup-of-a-virtual-machine-in-a-web-browser-using-kasm-and-docker-01f3445146d1" rel="external nofollow noopener" target="_blank">check it out here</a>.</p> <p>One of the biggest frustrations in recent years when it comes to virtual machines was the move from x86/AMD to ARM for Apple devices. However, a neat trick in Docker is that we can have it emulate a platform. Couple this with the Kasm VNC running Kali/Ubuntu, and we can actually spin up a quick web-based VM, and we can also choose whether we want it to be ARM-based or x86/AMD-based. This becomes really useful where some containers/apps will only run on x86 variants.</p> <p>Here are the one-liners that we need to fire up our Kasm instances quickly, supporting root and architectures as needed. We can use the command lscpu to then confirm that the VMs are running on the expected architecture.</p> <p>Thanks to <a href="https://forums.docker.com/t/run-x86-intel-and-arm-based-images-on-apple-silicon-m1-macs/117123" rel="external nofollow noopener" target="_blank">this message board</a> where they discussed running x86 Docker containers on Mac!</p> <h3>Ubuntu (ARM)</h3> <pre>sudo docker run --rm -it --user root --platform linux/arm64 --shm-size=512m -p 6901:6901 -e VNC_PW=password kasmweb/ubuntu-jammy-desktop-vpn:1.17.0</pre> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*Gn0c86v7ylGJ23jgQHqaFQ.png"></figure> <h3>Ubuntu (x86/AMD)</h3> <pre>sudo docker run --rm -it --user root --platform linux/amd64 --shm-size=512m -p 6901:6901 -e VNC_PW=password kasmweb/ubuntu-jammy-desktop-vpn:1.17.0</pre> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*45DBNXer3M3peyzkUV2kKg.png"></figure> <h3>Kali (ARM)</h3> <pre>sudo docker run --rm -it --user root --platform linux/arm64 --shm-size=512m -p 6905:6901 -e VNC_PW=password kasmweb/kali-rolling-desktop:1.17.0</pre> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*PgZ_paDRxfRgHzprHPPHog.png"></figure> <h3>Kali (x86/AMD)</h3> <pre>sudo docker run --rm -it --user root --platform linux/amd64 --shm-size=512m -p 6905:6901 -e VNC_PW=password kasmweb/kali-rolling-desktop:1.17.0</pre> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*W-k9grBhYWY451Zlp3MwWA.png"></figure> <h3>One more tweak…</h3> <p>The above examples create a Docker container and then remove this when the container is terminated (since we are passing --rm).</p> <p>Depending on how you want to use the VMs, we may want to remove this for a persistant VM environment. In which case, we may also want to give our container a name so that we can refer to it easily and restart it where we left off.</p> <pre>sudo docker run --name mykali -it --user root --platform linux/amd64 --shm-size=512m -p 6905:6901 -e VNC_PW=password kasmweb/kali-rolling-desktop:1.17.0<br>sudo docker run --name myubuntu -it --user root --platform linux/amd64 --shm-size=512m -p 6901:6901 -e VNC_PW=password kasmweb/ubuntu-jammy-desktop-vpn:1.17.0</pre> <p>We can use the VM as expected, and terminate the container when we are ready. When we want to then use the VM again we simply start the container again.</p> <pre>sudo docker start mykali<br>sudo docker start myubuntu</pre> <p><img src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=b982e4536f6c" width="1" height="1" alt=""></p> </body></html>